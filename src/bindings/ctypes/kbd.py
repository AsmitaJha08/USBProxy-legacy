#!/usr/bin/env python

import usbproxy
import deviceproxy

'''
Device: 12 01 10 01 00 00 00 08 03 06 f2 00 12 01 01 02 00 01
  Manufacturer: NOVATEK
  Product:      USB Keyboard
	*Config(1): 09 02 3b 00 02 01 00 a0 32
		Interface(0):
			*Alt(0): 09 04 00 00 01 03 01 01 00
				HID: 09 21 10 01 00 01 22 41 00
				EP(81): 07 05 81 03 08 00 0a
		Interface(1):
			*Alt(0): 09 04 01 00 01 03 00 00 00
				HID: 09 21 10 01 00 01 22 7d 00
				EP(82): 07 05 82 03 08 00 0a
'''

device_desc = [
	18, 1, 0x10, 0x01, 0x00, 0x00, 0x00,
	0x08, 0x03, 0x06, 0xf2, 0x00, 0x12,
	0x01, 0x00, 0x00, 0x00, 1
]

config_desc = [
	9, 0x02, 0x3b, 0x00, 0x02, 0x01, 0x00, 0xa0, 0x32,
	
	0x09, 0x04, 0x00, 0x00, 0x01, 0x03, 0x01, 0x01, 0x00,
	0x09, 0x21, 0x10, 0x01, 0x00, 0x01, 0x22, 0x41, 0x00,
	0x07, 0x05, 0x81, 0x03, 0x08, 0x00, 0x0a,
	
	0x09, 0x04, 0x01, 0x00, 0x01, 0x03, 0x00, 0x00, 0x00,
	0x09, 0x21, 0x10, 0x01, 0x00, 0x01, 0x22, 0x7d, 0x00,
	0x07, 0x05, 0x82, 0x03, 0x08, 0x00, 0x0a
]

class Keyboard(deviceproxy.DeviceProxy):
	pass

if __name__ == '__main__':
	usbproxy.init()
	device = Keyboard(device_desc, config_desc)
	deviceproxy.init(device)
	x = usbproxy.register_deviceproxy(
		connect_func=deviceproxy.connect,
		control_request_func=deviceproxy.control_req
		)
	
	usbproxy.lib.print_config()
	usbproxy.lib.load_plugins()
	usbproxy.run()